# ะขะะฅะะะงะะกะะะ ะะะะะะะ
## ะัะพะตะบั: Nova Forma CRM
### CRM-ัะธััะตะผะฐ ัะฟัะฐะฒะปะตะฝะธั ัะตััััะฐะผะธ ะผะตะฑะตะปัะฝะพะณะพ ะฟัะพะธะทะฒะพะดััะฒะฐ

---

## 1. ะะะฉะะฏ ะะะคะะะะะฆะะฏ

**ะะฐะทะฒะฐะฝะธะต ะฟัะพะตะบัะฐ:** Nova Forma CRM

**ะขะธะฟ ะฟัะพะตะบัะฐ:** ะฃัะตะฑะฝัะน ะฟัะพะตะบั โ CRM-ัะธััะตะผะฐ ะดะปั ัะฟัะฐะฒะปะตะฝะธั ัะตััััะฐะผะธ ะฟัะตะดะฟัะธััะธั

**ะัะตะดะผะตัะฝะฐั ะพะฑะปะฐััั:** ะะตะฑะตะปัะฝะพะต ะฟัะพะธะทะฒะพะดััะฒะพ

**ะกัะตะบ ัะตัะฝะพะปะพะณะธะน:**
- **ะะฐะทะฐ ะดะฐะฝะฝัั:** PostgreSQL 14+
- **GUI:** PyQt5/PyQt6
- **ะฏะทัะบ ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธั:** Python 3.9+
- **ะััะธัะตะบัััะฐ:** ะขััััะปะพะนะฝะฐั (Presentation โ Business Logic โ Database)

**ะขัะตะฑะพะฒะฐะฝะธั ะบ ะพะฑััะผั ะดะฐะฝะฝัั:**
- ะัะฝะพะฒะฝัะต ัะฐะฑะปะธัั: 100-150 ะทะฐะฟะธัะตะน
- ะกะฟัะฐะฒะพัะฝะธะบะธ ะธ ััะปะพะฒะฝะพ-ะฟะพััะพัะฝะฝัะต ะดะฐะฝะฝัะต: 10-15 ะทะฐะฟะธัะตะน
- ะะธะฝะธะผัะผ 6 ัะฐะฑะปะธั ะฒ ะะ
- ะฅัะฐะฝะธะผัะต ะฟัะพัะตะดััั, ััะธะณะณะตัั ะธ ััะฝะบัะธะธ (ะพะฑัะทะฐัะตะปัะฝะพ ะดะปั ยซะพัะปะธัะฝะพยป)

---

## 2. ะะะะกะะะะ ะะะะะะะขะะะ ะะะะะกะขะ

### 2.1 ะัะฝะพะฒะฝัะต ะทะฐะดะฐัะธ ัะธััะตะผั

1. **ะฃะฟัะฐะฒะปะตะฝะธะต ัะบะปะฐะดะพะผ** โ ัััั ะผะฐัะตัะธะฐะปะพะฒ, ััััั ะธ ะบะพะผะฟะปะตะบััััะธั
2. **ะฃะฟัะฐะฒะปะตะฝะธะต ะฟัะพะธะทะฒะพะดััะฒะพะผ** โ ะบะพะฝััะพะปั ัะฑะพัะบะธ, ะพัะดะตะปะบะธ, ะบะพะฝััะพะปั ะบะฐัะตััะฒะฐ
3. **ะฃะฟัะฐะฒะปะตะฝะธะต ะทะฐะบะฐะทะฐะผะธ** โ ะพั ัะตะณะธัััะฐัะธะธ ะดะพ ะฒัะฟะพะปะฝะตะฝะธั
4. **ะฃะฟัะฐะฒะปะตะฝะธะต ัะพัััะดะฝะธะบะฐะผะธ** โ ะณัะฐัะธะบะธ ัะฐะฑะพัั, ัะฐัะฟัะตะดะตะปะตะฝะธะต ะทะฐะบะฐะทะพะฒ
5. **ะะฝะฐะปะธัะธะบะฐ** โ ะพััััั ะฟะพ ัััะตะบัะธะฒะฝะพััะธ ะฟัะพะธะทะฒะพะดััะฒะฐ
6. **ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ** โ ัะธััะตะผะฐ ะฐะฒัะพัะธะทะฐัะธะธ ั ัะฐะทะดะตะปะตะฝะธะตะผ ัะพะปะตะน

### 2.2 ะะตะนััะฒัััะธะต ะปะธัะฐ (Actors/Stakeholders)

| ะะพะปั | ะคัะฝะบัะธะธ | ะัะธะฒะธะปะตะณะธะธ |
|------|---------|-----------|
| **ะกะฑะพััะธะบ** | ะฃััั ะฒัะฟะพะปะฝะตะฝะธั ะทะฐะบะฐะทะพะฒ, ะฒะฝะตัะตะฝะธะต ะดะฐะฝะฝัั ะพ ะผะฐัะตัะธะฐะปะฐั, ะฟัะพัะผะพัั ะณัะฐัะธะบะฐ | ะะณัะฐะฝะธัะตะฝะฝัะน ะดะพัััะฟ ะบ ะปะธัะฝะพะผั ะบะฐะฑะธะฝะตัั |
| **ะะตะฝะตะดะถะตั** | ะะตะณะธัััะฐัะธั ะทะฐะบะฐะทะพะฒ, ัะฟัะฐะฒะปะตะฝะธะต ะผะฐัะตัะธะฐะปะฐะผะธ, ะบะพะฝััะพะปั ะฟัะพะธะทะฒะพะดััะฒะฐ, ัะฟัะฐะฒะปะตะฝะธะต ัะพัััะดะฝะธะบะฐะผะธ | ะะฐััะธัะตะฝะฝัะน ะดะพัััะฟ, ัะพัะผะธัะพะฒะฐะฝะธะต ะพััััะพะฒ |
| **ะะธัะตะบัะพั** | ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะตััะพะฝะฐะปะพะผ, ัะฟัะฐะฒะปะตะฝะธะต ัะตะฝะฐะผะธ, ะทะฐะบัะฟะบะธ, ัััะฐัะตะณะธัะตัะบะธะต ัะตัะตะฝะธั | ะะพะปะฝัะน ะดะพัััะฟ ะบะพ ะฒัะตะผ ััะฝะบัะธัะผ |

---

## 3. ะะะฅะะขะะะขะฃะะ ะกะะกะขะะะซ

### 3.1 ะขััััะปะพะนะฝะฐั ะฐััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ           PRESENTATION LAYER (PyQt5)                    โ
โ  - ะคะพัะผั ะดะปั CRUD ะพะฟะตัะฐัะธะน                              โ
โ  - ะะธะดะถะตัั ะดะปั ะพัะพะฑัะฐะถะตะฝะธั ะดะฐะฝะฝัั                       โ
โ  - ะะธะฐะปะพะณะธ ะฐะฒัะพัะธะทะฐัะธะธ ะธ ะปะธัะฝะพะณะพ ะบะฐะฑะธะฝะตัะฐ              โ
โ  - ะคะพัะผะฐ ะณะตะฝะตัะฐัะธะธ ะพััััะพะฒ ะธ ะดะพะบัะผะตะฝัะพะฒ                โ
โ  - ะะฐะปะธะดะฐัะธั ะฟะพะปัะทะพะฒะฐัะตะปััะบะพะณะพ ะฒะฒะพะดะฐ                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
         โ               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         BUSINESS LOGIC LAYER (Python)                   โ
โ  - ะะธะทะฝะตั-ะฟัะฐะฒะธะปะฐ ะธ ะพะณัะฐะฝะธัะตะฝะธั                         โ
โ  - ะัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ะดะฐะฝะฝัั                                โ
โ  - ะฃะฟัะฐะฒะปะตะฝะธะต ัะพััะพัะฝะธะตะผ ะฟัะธะปะพะถะตะฝะธั                     โ
โ  - ะะฑัะฐะฑะพัะบะฐ ะฐะฒัะพัะธะทะฐัะธะธ ะธ ัะพะปะตะน                        โ
โ  - ะะตะฝะตัะฐัะธั ะพััััะพะฒ (PDF, Excel)                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
         โ               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ      DATABASE LAYER (PostgreSQL + Views)                โ
โ  - ะขะฐะฑะปะธัั ะดะฐะฝะฝัั                                       โ
โ  - ะัะตะดััะฐะฒะปะตะฝะธั (Views) ะดะปั ัะบัััะธั ID ะธ ะบะปััะตะน       โ
โ  - ะฅัะฐะฝะธะผัะต ะฟัะพัะตะดััั ะดะปั ะฑะธะทะฝะตั-ะปะพะณะธะบะธ                 โ
โ  - ะขัะธะณะณะตัั ะดะปั ะฐะฒัะพะผะฐัะธะทะฐัะธะธ ะธ ะบะพะฝััะพะปั ัะตะปะพััะฝะพััะธ   โ
โ  - ะคัะฝะบัะธะธ ะดะปั ะฒััะธัะปะตะฝะธะน ะธ ะฟัะพะฒะตัะพะบ                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 3.2 ะะปััะตะฒะพะน ะฟัะธะฝัะธะฟ: "ะขะพะฝะบะธะน ะบะปะธะตะฝั"

**ะคะธะปะพัะพัะธั:** ะัั ะปะพะณะธะบะฐ ะพะฑัะฐะฑะพัะบะธ ะดะฐะฝะฝัั, ะฟัะพะฒะตัะบะธ ะธ ะฒััะธัะปะตะฝะธั ะฒัะฟะพะปะฝััััั ะฝะฐ ััะพะฒะฝะต ะะ.

- โ **ะงัะพ ะดะตะปะฐะตั ะะ:** ะัะพะฒะตัะบะธ, ััะธะณะณะตัั, ะพะณัะฐะฝะธัะตะฝะธั, ะฒััะธัะปะตะฝะธั, ัะธะปัััะฐัะธั
- โ **ะงัะพ ะดะตะปะฐะตั PyQt:** ะขะพะปัะบะพ ะพัะพะฑัะฐะถะตะฝะธะต ะดะฐะฝะฝัั ะธ ะธะฝัะตััะตะนั
- โ **ะะ ะะะะะขะฌ:** ะกะปะพะถะฝัะต ะฒััะธัะปะตะฝะธั, ะฟัะพะฒะตัะบะธ ะฑะธะทะฝะตั-ะฟัะฐะฒะธะป ะฒ ะฟัะธะปะพะถะตะฝะธะธ
- โ **ะะ ะะกะะะะฌะะะะะขะฌ:** localStorage, sessionStorage, ะบััะธัะพะฒะฐะฝะธะต ัะปะพะถะฝัั ะดะฐะฝะฝัั

### 3.3 ะะธะฝะธะผะธะทะฐัะธั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะบะปััะตะน (Primary/Foreign Keys)

**ะขัะตะฑะพะฒะฐะฝะธะต:** ะัะธ ะพัะพะฑัะฐะถะตะฝะธะธ ะดะฐะฝะฝัั ะฟะพะบะฐะทัะฒะฐัั ะฝะต ะบะพะดั/ID, ะฐ ัะตะปะพะฒะตะบะพัะธัะฐะตะผัะต ะทะฝะฐัะตะฝะธั.

**ะะตะฐะปะธะทะฐัะธั:**
```sql
-- ะัะธะผะตั: ะะผะตััะพ id_ัะฑะพััะธะบะฐ ะฟะพะบะฐะทัะฒะฐะตะผ ะคะะ
CREATE VIEW v_ะทะฐะบะฐะทั_ั_ะดะฐะฝะฝัะผะธ AS
SELECT 
    ะท.id_ะทะฐะบะฐะทะฐ,
    ะบ.ัะธะพ AS "ะะปะธะตะฝั",
    ะท.ะดะฐัะฐ_ะทะฐะบะฐะทะฐ,
    ะท.ััะฐััั,
    ั.ัะธะพ AS "ะะตะฝะตะดะถะตั" -- ะฒะผะตััะพ id_ะผะตะฝะตะดะถะตัะฐ
FROM ะทะฐะบะฐะทั ะท
JOIN ะบะปะธะตะฝัั ะบ ON ะท.id_ะบะปะธะตะฝัะฐ = ะบ.id_ะบะปะธะตะฝัะฐ
LEFT JOIN ัะพัััะดะฝะธะบะธ ั ON ะท.id_ะผะตะฝะตะดะถะตัะฐ = ั.id_ัะพัััะดะฝะธะบะฐ;
```

**ะัะฐะฒะธะปะพ:** 
- ะ ะะ ะธัะฟะพะปัะทัะตะผ ID ะดะปั ัะฒัะทะตะน
- ะะฐ ััะพะฒะฝะต Views ะฟะตัะตะฒะพะดะธะผ ID ะฒ ะทะฝะฐัะธะผัะต ะดะฐะฝะฝัะต
- ะะฐ ััะพะฒะฝะต UI ะธัะฟะพะปัะทัะตะผ Views, ะฝะต ะฟััะผัะต ัะฐะฑะปะธัั

---

## 4. ะกะขะะฃะะขะฃะะ ะะ ะ ะขะะะะะฆะซ

### 4.1 ะขะฐะฑะปะธัั ะพัะฝะพะฒะฝัั ัััะฝะพััะตะน

#### 1. **users** (ะะพะปัะทะพะฒะฐัะตะปะธ)
```
ะะพะปั:
- id_user (PK, SERIAL)
- login (VARCHAR UNIQUE)
- password_hash (VARCHAR)
- role (VARCHAR: 'ัะฑะพััะธะบ', 'ะผะตะฝะตะดะถะตั', 'ะดะธัะตะบัะพั')
- is_active (BOOLEAN)
- created_at (TIMESTAMP)
- last_login (TIMESTAMP)
- id_ัะพัััะดะฝะธะบะฐ (FK โ ัะพัััะดะฝะธะบะธ)
```

#### 2. **ัะพัััะดะฝะธะบะธ** (ะกะพัััะดะฝะธะบะธ)
```
ะะพะปั:
- id_ัะพัััะดะฝะธะบะฐ (PK, SERIAL)
- ัะธะพ (VARCHAR NOT NULL)
- ะฝะพะผะตั_ัะตะปะตัะพะฝะฐ (VARCHAR UNIQUE)
- ะดะฐัะฐ_ัะพะถะดะตะฝะธั (DATE)
- ะดะพะปะถะฝะพััั (VARCHAR: 'ัะฑะพััะธะบ', 'ะผะตะฝะตะดะถะตั', 'ะดะธัะตะบัะพั')
- ะทะฐัะฟะปะฐัะฐ (NUMERIC)
- ะดะฐัะฐ_ะฝะฐะนะผะฐ (DATE)
- ะดะฐัะฐ_ัะฒะพะปัะฝะตะฝะธั (DATE NULL)
```

#### 3. **ะบะปะธะตะฝัั** (ะะปะธะตะฝัั)
```
ะะพะปั:
- id_ะบะปะธะตะฝัะฐ (PK, SERIAL)
- ัะธะพ (VARCHAR)
- ะธะฝะฝ (VARCHAR UNIQUE NULL)
- ะฝะพะผะตั_ัะตะปะตัะพะฝะฐ (VARCHAR)
- ะฐะดัะตั (TEXT)
- ะดะฐัะฐ_ัะตะณะธัััะฐัะธะธ (DATE)
- ััะผะผะฐ_ะทะฐะบะฐะทะพะฒ (NUMERIC DEFAULT 0) -- ะบัั ะดะปั ะฐะฝะฐะปะธัะธะบะธ
```

#### 4. **ะผะฐัะตัะธะฐะปั** (ะกะฟัะฐะฒะพัะฝะธะบ ะผะฐัะตัะธะฐะปะพะฒ)
```
ะะพะปั:
- id_ะผะฐัะตัะธะฐะปะฐ (PK, SERIAL)
- ะฐััะธะบัะป_ะผะฐัะตัะธะฐะปะฐ (VARCHAR UNIQUE)
- ะฝะฐะธะผะตะฝะพะฒะฐะฝะธะต (VARCHAR NOT NULL)
- ะบะพะปะธัะตััะฒะพ_ะฝะฐ_ัะบะปะฐะดะต (INTEGER DEFAULT 1)
- ะตะดะธะฝะธัะฐ_ะธะทะผะตัะตะฝะธั (VARCHAR: 'ัั', 'ะบะณ', 'ะป')
- ะผะธะฝะธะผะฐะปัะฝัะน_ะพััะฐัะพะบ (INTEGER DEFAULT 10)
- ัะตะฝะฐ_ะทะฐ_ะตะดะธะฝะธัั (NUMERIC)
```

#### 5. **ะทะฐะณะพัะพะฒะบะธ** (ะะฐะณะพัะพะฒะบะธ/ะะพะปััะฐะฑัะธะบะฐัั)
```
ะะพะปั:
- id_ะทะฐะณะพัะพะฒะบะธ (PK, SERIAL)
- ะฐััะธะบัะป_ะทะฐะณะพัะพะฒะบะธ (VARCHAR UNIQUE)
- ะฝะฐะธะผะตะฝะพะฒะฐะฝะธะต (VARCHAR NOT NULL)
- ะบะพะปะธัะตััะฒะพ_ะณะพัะพะฒัั (INTEGER DEFAULT 0)
- ัััะดะพัะผะบะพััั_ัะฐัะพะฒ (NUMERIC) -- ะดะปั ะฟะปะฐะฝะธัะพะฒะฐะฝะธั
- ะพะฟะธัะฐะฝะธะต (TEXT)
```

#### 6. **ะธะทะดะตะปะธั** (ะะพัะพะฒัะต ะธะทะดะตะปะธั)
```
ะะพะปั:
- id_ะธะทะดะตะปะธั (PK, SERIAL)
- ะฐััะธะบัะป_ะธะทะดะตะปะธั (VARCHAR UNIQUE)
- ะฝะฐะธะผะตะฝะพะฒะฐะฝะธะต (VARCHAR NOT NULL)
- ัะธะฟ (VARCHAR: 'ัััะป', 'ััะพะป', 'ัะบะฐั')
- ัะฐะทะผะตัั (VARCHAR)
- ะบะพะปะธัะตััะฒะพ_ะฝะฐ_ัะบะปะฐะดะต (INTEGER DEFAULT 1)
- ััะพะธะผะพััั (NUMERIC)
- ะผะฐัะตัะธะฐะป_ะบะพัะฟััะฐ (VARCHAR)
- ะณะฐัะฐะฝัะธั_ะผะตัััะตะฒ (INTEGER)
```

#### 7. **ะทะฐะบะฐะทั** (ะะฐะบะฐะทั ะบะปะธะตะฝัะพะฒ)
```
ะะพะปั:
- id_ะทะฐะบะฐะทะฐ (PK, SERIAL)
- id_ะบะปะธะตะฝัะฐ (FK โ ะบะปะธะตะฝัั)
- id_ะผะตะฝะตะดะถะตัะฐ (FK โ ัะพัััะดะฝะธะบะธ, ะดะพะฟัััะธ NULL)
- ะดะฐัะฐ_ะทะฐะบะฐะทะฐ (DATE)
- ะดะฐัะฐ_ะณะพัะพะฒะฝะพััะธ (DATE)
- ััะฐััั (VARCHAR: 'ะฟัะธะฝัั', 'ะฒ_ะพะฑัะฐะฑะพัะบะต', 'ะฒัะฟะพะปะฝะตะฝ', 'ะพัะผะตะฝัะฝ')
- ััะผะผะฐ_ะทะฐะบะฐะทะฐ (NUMERIC)
- ะฟัะธะผะตัะฐะฝะธั (TEXT)
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)
```

#### 8. **ัะพััะฐะฒ_ะทะฐะบะฐะทะฐ** (M:M ัะฒัะทั ะทะฐะบะฐะทะพะฒ ะธ ะธะทะดะตะปะธะน)
```
ะะพะปั:
- id_ัะพััะฐะฒ_ะทะฐะบะฐะทะฐ (PK, SERIAL)
- id_ะทะฐะบะฐะทะฐ (FK โ ะทะฐะบะฐะทั)
- id_ะธะทะดะตะปะธั (FK โ ะธะทะดะตะปะธั)
- ะบะพะปะธัะตััะฒะพ_ะธะทะดะตะปะธะน (INTEGER > 0)
- ัะตะฝะฐ_ะทะฐ_ะตะดะธะฝะธัั (NUMERIC)
- ััะผะผะฐ (NUMERIC) -- ัะตะฝะฐ * ะบะพะปะธัะตััะฒะพ
```

#### 9. **ัะฐััะพะด_ะผะฐัะตัะธะฐะปะพะฒ** (M:M ัะฒัะทั ะทะฐะณะพัะพะฒะพะบ ะธ ะผะฐัะตัะธะฐะปะพะฒ)
```
ะะพะปั:
- id_ัะฐััะพะด (PK, SERIAL)
- id_ะทะฐะณะพัะพะฒะบะธ (FK โ ะทะฐะณะพัะพะฒะบะธ)
- id_ะผะฐัะตัะธะฐะปะฐ (FK โ ะผะฐัะตัะธะฐะปั)
- ะบะพะปะธัะตััะฒะพ_ะผะฐัะตัะธะฐะปะฐ (INTEGER > 0)
```

#### 10. **ัะพััะฐะฒ_ะธะทะดะตะปะธั** (M:M ัะฒัะทั ะธะทะดะตะปะธะน ะธ ะทะฐะณะพัะพะฒะพะบ)
```
ะะพะปั:
- id_ัะพััะฐะฒ_ะธะทะดะตะปะธั (PK, SERIAL)
- id_ะธะทะดะตะปะธั (FK โ ะธะทะดะตะปะธั)
- id_ะทะฐะณะพัะพะฒะบะธ (FK โ ะทะฐะณะพัะพะฒะบะธ)
- ะบะพะปะธัะตััะฒะพ_ะทะฐะณะพัะพะฒะพะบ (INTEGER > 0)
```

#### 11. **ะณัะฐัะธะบ_ัะฐะฑะพัั** (ะัะฐัะธะบ ัะพัััะดะฝะธะบะพะฒ)
```
ะะพะปั:
- id_ะณัะฐัะธะบะฐ (PK, SERIAL)
- id_ัะพัััะดะฝะธะบะฐ (FK โ ัะพัััะดะฝะธะบะธ)
- ะดะฐัะฐ (DATE)
- ััะฐััั (VARCHAR: 'ัะฐะฑะพัะธะน', 'ะฒััะพะดะฝะพะน', 'ะพัะฟััะบ', 'ะฑะพะปัะฝะธัะฝัะน')
```

#### 12. **ะทะฐะบัะฟะบะธ_ะผะฐัะตัะธะฐะปะพะฒ** (ะะฐะบัะฟะบะธ)
```
ะะพะปั:
- id_ะทะฐะบัะฟะบะธ (PK, SERIAL)
- ะดะฐัะฐ_ะทะฐะบัะฟะบะธ (DATE)
- ััะฐััั (VARCHAR: 'ะพะถะธะดะฐะตั_ะฟะพะดัะฒะตัะถะดะตะฝะธั', 'ะฟะพะดัะฒะตัะถะดะตะฝะพ', 'ะฒัะฟะพะปะฝะตะฝะพ')
- ะฟะพััะฐะฒัะธะบ (VARCHAR)
- ััะผะผะฐ_ะทะฐะบัะฟะบะธ (NUMERIC)
```

#### 13. **ัะพััะฐะฒ_ะทะฐะบัะฟะบะธ** (M:M ัะฒัะทั ะทะฐะบัะฟะพะบ ะธ ะผะฐัะตัะธะฐะปะพะฒ)
```
ะะพะปั:
- id_ัะพััะฐะฒ_ะทะฐะบัะฟะบะธ (PK, SERIAL)
- id_ะทะฐะบัะฟะบะธ (FK โ ะทะฐะบัะฟะบะธ_ะผะฐัะตัะธะฐะปะพะฒ)
- id_ะผะฐัะตัะธะฐะปะฐ (FK โ ะผะฐัะตัะธะฐะปั)
- ะบะพะปะธัะตััะฒะพ (INTEGER > 0)
- ัะตะฝะฐ_ะทะฐ_ะตะดะธะฝะธัั (NUMERIC)
```

#### 14. **ะฟะปะฐะฝ_ะทะฐะณะพัะพะฒะพะบ** (ะะปะฐะฝ ะฟัะพะธะทะฒะพะดััะฒะฐ)
```
ะะพะปั:
- id_ะฟะปะฐะฝะฐ (PK, SERIAL)
- id_ะทะฐะบะฐะทะฐ (FK โ ะทะฐะบะฐะทั)
- id_ะทะฐะณะพัะพะฒะบะธ (FK โ ะทะฐะณะพัะพะฒะบะธ)
- id_ัะฑะพััะธะบะฐ (FK โ ัะพัััะดะฝะธะบะธ)
- ะฟะปะฐะฝะพะฒะพะต_ะบะพะปะธัะตััะฒะพ (INTEGER)
- ัะฐะบัะธัะตัะบะพะต_ะบะพะปะธัะตััะฒะพ (INTEGER DEFAULT 0)
- ะดะฐัะฐ_ะฟะปะฐะฝ (DATE)
- ะดะฐัะฐ_ัะฐะบั (DATE NULL)
- ััะฐััั (VARCHAR: 'ะฟัะธะฝััะพ', 'ะฒ_ัะฐะฑะพัะต', 'ะฒัะฟะพะปะฝะตะฝะพ', 'ะพัะผะตะฝะตะฝะพ', 'ะฟัะพััะพัะตะฝะพ')
```

#### 15. **ะปะพะณะธ_ะพะฟะตัะฐัะธะน** (ะัะดะธั)
```
ะะพะปั:
- id_ะปะพะณะฐ (PK, SERIAL)
- id_user (FK โ users)
- ัะฐะฑะปะธัะฐ (VARCHAR)
- ะพะฟะตัะฐัะธั (VARCHAR: 'INSERT', 'UPDATE', 'DELETE')
- ะดะฐะฝะฝัะต_ะดะพ (JSONB)
- ะดะฐะฝะฝัะต_ะฟะพัะปะต (JSONB)
- ะดะฐัะฐ_ะฒัะตะผั (TIMESTAMP)
```

### 4.2 ะกะฟัะฐะฒะพัะฝัะต ัะฐะฑะปะธัั (10-15 ะทะฐะฟะธัะตะน)

#### **ะดะพะปะถะฝะพััะธ_ัะฟัะฐะฒะพัะฝะธะบ**
```
id_ะดะพะปะถะฝะพััะธ | ะฝะฐะธะผะตะฝะพะฒะฐะฝะธะต | ััะพะฒะตะฝั_ะดะพัััะฟะฐ
1            | ะกะฑะพััะธะบ      | 1
2            | ะะตะฝะตะดะถะตั     | 2
3            | ะะธัะตะบัะพั     | 3
```

#### **ััะฐัััั_ัะฟัะฐะฒะพัะฝะธะบ**
```
id_ััะฐัััะฐ | ัะฐะฑะปะธัะฐ_ะฟัะธะผะตะฝะตะฝะธั | ะทะฝะฐัะตะฝะธะต         | ะพะฟะธัะฐะฝะธะต
1          | ะทะฐะบะฐะทั             | ะฟัะธะฝัั           | ะะฐะบะฐะท ะฟัะธะฝัั
2          | ะทะฐะบะฐะทั             | ะฒ_ะพะฑัะฐะฑะพัะบะต      | ะะฐะบะฐะท ะฒ ะพะฑัะฐะฑะพัะบะต
...
```

---

## 5. ะะะะะกะขะะะะะะะฏ (VIEWS)

### 5.1 ะัะตะดััะฐะฒะปะตะฝะธั ะดะปั ัะบัััะธั ID

```sql
-- ะะฐะบะฐะทั ั ะธะผะตะฝะฐะผะธ (ะฒะผะตััะพ ID)
CREATE VIEW v_ะทะฐะบะฐะทั_ั_ะดะฐะฝะฝัะผะธ AS
SELECT 
    ะท.id_ะทะฐะบะฐะทะฐ,
    ะบ.ัะธะพ AS "ะะปะธะตะฝั",
    ั.ัะธะพ AS "ะะตะฝะตะดะถะตั",
    ะท.ะดะฐัะฐ_ะทะฐะบะฐะทะฐ,
    ะท.ะดะฐัะฐ_ะณะพัะพะฒะฝะพััะธ,
    ะท.ััะฐััั,
    ะท.ััะผะผะฐ_ะทะฐะบะฐะทะฐ
FROM ะทะฐะบะฐะทั ะท
JOIN ะบะปะธะตะฝัั ะบ ON ะท.id_ะบะปะธะตะฝัะฐ = ะบ.id_ะบะปะธะตะฝัะฐ
LEFT JOIN ัะพัััะดะฝะธะบะธ ั ON ะท.id_ะผะตะฝะตะดะถะตัะฐ = ั.id_ัะพัััะดะฝะธะบะฐ;

-- ะะฐัะตัะธะฐะปั ั ััะพะฒะฝะตะผ ะทะฐะฟะฐัะฐ
CREATE VIEW v_ะผะฐัะตัะธะฐะปั_ัะพ_ััะฐัััะพะผ AS
SELECT 
    ะผ.id_ะผะฐัะตัะธะฐะปะฐ,
    ะผ.ะฐััะธะบัะป_ะผะฐัะตัะธะฐะปะฐ,
    ะผ.ะฝะฐะธะผะตะฝะพะฒะฐะฝะธะต,
    ะผ.ะบะพะปะธัะตััะฒะพ_ะฝะฐ_ัะบะปะฐะดะต,
    ะผ.ะผะธะฝะธะผะฐะปัะฝัะน_ะพััะฐัะพะบ,
    CASE 
        WHEN ะผ.ะบะพะปะธัะตััะฒะพ_ะฝะฐ_ัะบะปะฐะดะต <= ะผ.ะผะธะฝะธะผะฐะปัะฝัะน_ะพััะฐัะพะบ THEN 'ะขัะตะฑัะตััั ะทะฐะบัะฟะบะฐ'
        ELSE 'ะ ะฝะพัะผะต'
    END AS "ะกัะฐััั ะทะฐะฟะฐัะฐ"
FROM ะผะฐัะตัะธะฐะปั ะผ;

-- ะะปะฐะฝ ัะฐะฑะพั ัะฑะพััะธะบะพะฒ
CREATE VIEW v_ะฟะปะฐะฝ_ัะฐะฑะพั AS
SELECT 
    ะฟะท.id_ะฟะปะฐะฝะฐ,
    ั.ัะธะพ AS "ะกะฑะพััะธะบ",
    ะท.ะฝะฐะธะผะตะฝะพะฒะฐะฝะธะต AS "ะะฐะณะพัะพะฒะบะฐ",
    ะฟะท.ะฟะปะฐะฝะพะฒะพะต_ะบะพะปะธัะตััะฒะพ,
    ะฟะท.ัะฐะบัะธัะตัะบะพะต_ะบะพะปะธัะตััะฒะพ,
    ะฟะท.ะดะฐัะฐ_ะฟะปะฐะฝ,
    ะฟะท.ััะฐััั
FROM ะฟะปะฐะฝ_ะทะฐะณะพัะพะฒะพะบ ะฟะท
JOIN ัะพัััะดะฝะธะบะธ ั ON ะฟะท.id_ัะฑะพััะธะบะฐ = ั.id_ัะพัััะดะฝะธะบะฐ
JOIN ะทะฐะณะพัะพะฒะบะธ ะท ON ะฟะท.id_ะทะฐะณะพัะพะฒะบะธ = ะท.id_ะทะฐะณะพัะพะฒะบะธ;

-- ะกะพััะฐะฒ ะทะฐะบะฐะทะฐ ั ะธะผะตะฝะฐะผะธ
CREATE VIEW v_ัะพััะฐะฒ_ะทะฐะบะฐะทะฐ_ั_ะดะฐะฝะฝัะผะธ AS
SELECT 
    ัะท.id_ัะพััะฐะฒ_ะทะฐะบะฐะทะฐ,
    ะท.id_ะทะฐะบะฐะทะฐ,
    ะธ.ะฝะฐะธะผะตะฝะพะฒะฐะฝะธะต AS "ะะทะดะตะปะธะต",
    ัะท.ะบะพะปะธัะตััะฒะพ_ะธะทะดะตะปะธะน,
    ัะท.ัะตะฝะฐ_ะทะฐ_ะตะดะธะฝะธัั,
    ัะท.ััะผะผะฐ
FROM ัะพััะฐะฒ_ะทะฐะบะฐะทะฐ ัะท
JOIN ะทะฐะบะฐะทั ะท ON ัะท.id_ะทะฐะบะฐะทะฐ = ะท.id_ะทะฐะบะฐะทะฐ
JOIN ะธะทะดะตะปะธั ะธ ON ัะท.id_ะธะทะดะตะปะธั = ะธ.id_ะธะทะดะตะปะธั;
```

---

## 6. ะขะะะะะะะซ ะ ะคะฃะะะฆะะ

### 6.1 ะขัะธะณะณะตัั (Triggers)

#### **ะขัะธะณะณะตั: ะะฒัะพะผะฐัะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต ััะฐัััะฐ ะฟะปะฐะฝะฐ ะฟัะธ 100% ะฒัะฟะพะปะฝะตะฝะธะธ**
```sql
CREATE OR REPLACE FUNCTION f_ะพะฑะฝะพะฒะธัั_ััะฐััั_ะฟะปะฐะฝะฐ()
RETURNS TRIGGER AS $$
BEGIN
    IF NEW.ัะฐะบัะธัะตัะบะพะต_ะบะพะปะธัะตััะฒะพ >= NEW.ะฟะปะฐะฝะพะฒะพะต_ะบะพะปะธัะตััะฒะพ THEN
        NEW.ััะฐััั = 'ะฒัะฟะพะปะฝะตะฝะพ';
    END IF;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER tr_ะพะฑะฝะพะฒะธัั_ััะฐััั_ะฟะปะฐะฝะฐ
BEFORE UPDATE ON ะฟะปะฐะฝ_ะทะฐะณะพัะพะฒะพะบ
FOR EACH ROW
EXECUTE FUNCTION f_ะพะฑะฝะพะฒะธัั_ััะฐััั_ะฟะปะฐะฝะฐ();
```

#### **ะขัะธะณะณะตั: ะฃะผะตะฝััะตะฝะธะต ะพััะฐัะบะฐ ะผะฐัะตัะธะฐะปะฐ ะฟัะธ ะทะฐะบัะฟะบะต**
```sql
CREATE OR REPLACE FUNCTION f_ะพะฑะฝะพะฒะธัั_ะพััะฐัะพะบ_ะฟัะธ_ะทะฐะบัะฟะบะต()
RETURNS TRIGGER AS $$
BEGIN
    UPDATE ะผะฐัะตัะธะฐะปั
    SET ะบะพะปะธัะตััะฒะพ_ะฝะฐ_ัะบะปะฐะดะต = ะบะพะปะธัะตััะฒะพ_ะฝะฐ_ัะบะปะฐะดะต + NEW.ะบะพะปะธัะตััะฒะพ
    WHERE id_ะผะฐัะตัะธะฐะปะฐ = NEW.id_ะผะฐัะตัะธะฐะปะฐ;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER tr_ะพะฑะฝะพะฒะธัั_ะพััะฐัะพะบ_ะฟัะธ_ะทะฐะบัะฟะบะต
AFTER INSERT ON ัะพััะฐะฒ_ะทะฐะบัะฟะบะธ
FOR EACH ROW
EXECUTE FUNCTION f_ะพะฑะฝะพะฒะธัั_ะพััะฐัะพะบ_ะฟัะธ_ะทะฐะบัะฟะบะธ();
```

#### **ะขัะธะณะณะตั: ะัะพะฒะตัะบะฐ ัะฝะธะบะฐะปัะฝะพััะธ login ะฟัะธ ัะพะทะดะฐะฝะธะธ user**
```sql
CREATE OR REPLACE FUNCTION f_ะฟัะพะฒะตัะธัั_login_ัะฝะธะบะฐะปะตะฝ()
RETURNS TRIGGER AS $$
BEGIN
    IF EXISTS(SELECT 1 FROM users WHERE login = NEW.login AND id_user != NEW.id_user) THEN
        RAISE EXCEPTION 'ะะพะณะธะฝ ัะถะต ัััะตััะฒัะตั';
    END IF;
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER tr_ะฟัะพะฒะตัะธัั_login
BEFORE INSERT OR UPDATE ON users
FOR EACH ROW
EXECUTE FUNCTION f_ะฟัะพะฒะตัะธัั_login_ัะฝะธะบะฐะปะตะฝ();
```

#### **ะขัะธะณะณะตั: ะะตะดะตะฝะธะต ะปะพะณะพะฒ ะธะทะผะตะฝะตะฝะธะน**
```sql
CREATE OR REPLACE FUNCTION f_ะปะพะณะธัะพะฒะฐะฝะธะต_ะธะทะผะตะฝะตะฝะธะน()
RETURNS TRIGGER AS $$
BEGIN
    INSERT INTO ะปะพะณะธ_ะพะฟะตัะฐัะธะน (id_user, ัะฐะฑะปะธัะฐ, ะพะฟะตัะฐัะธั, ะดะฐะฝะฝัะต_ะดะพ, ะดะฐะฝะฝัะต_ะฟะพัะปะต, ะดะฐัะฐ_ะฒัะตะผั)
    VALUES (
        CURRENT_USER_ID(), -- ะฝัะถะฝะฐ ััะฝะบัะธั ะดะปั ะฟะพะปััะตะฝะธั ัะตะบััะตะณะพ user
        TG_TABLE_NAME,
        TG_OP,
        row_to_json(OLD),
        row_to_json(NEW),
        NOW()
    );
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;
```

### 6.2 ะฅัะฐะฝะธะผัะต ะฟัะพัะตะดััั

#### **ะัะพัะตะดััะฐ: ะัะพัะผะปะตะฝะธะต ะทะฐะบะฐะทะฐ ั ะฟัะพะฒะตัะบะฐะผะธ**
```sql
CREATE OR REPLACE FUNCTION f_ะพัะพัะผะธัั_ะทะฐะบะฐะท(
    p_id_ะบะปะธะตะฝัะฐ INTEGER,
    p_ะดะฐัะฐ_ะณะพัะพะฒะฝะพััะธ DATE,
    p_id_ะผะตะฝะตะดะถะตัะฐ INTEGER DEFAULT NULL
) RETURNS INTEGER AS $$
DECLARE
    v_id_ะทะฐะบะฐะทะฐ INTEGER;
BEGIN
    -- ะัะพะฒะตัะบะฐ: ะดะฐัะฐ ะณะพัะพะฒะฝะพััะธ >= ัะตะบััะตะน ะดะฐัั
    IF p_ะดะฐัะฐ_ะณะพัะพะฒะฝะพััะธ < CURRENT_DATE THEN
        RAISE EXCEPTION 'ะะฐัะฐ ะณะพัะพะฒะฝะพััะธ ะฝะต ะผะพะถะตั ะฑััั ะฒ ะฟัะพัะปะพะผ';
    END IF;
    
    -- ะัะพะฒะตัะบะฐ: ะผะธะฝะธะผัะผ 24 ัะฐัะฐ ะฝะฐ ะฒัะฟะพะปะฝะตะฝะธะต
    IF (p_ะดะฐัะฐ_ะณะพัะพะฒะฝะพััะธ - CURRENT_DATE) < 1 THEN
        RAISE EXCEPTION 'ะะธะฝะธะผะฐะปัะฝะพะต ะฒัะตะผั ะฒัะฟะพะปะฝะตะฝะธั ะทะฐะบะฐะทะฐ - ัััะบะธ';
    END IF;
    
    -- ะกะพะทะดะฐะฝะธะต ะทะฐะบะฐะทะฐ
    INSERT INTO ะทะฐะบะฐะทั 
    (id_ะบะปะธะตะฝัะฐ, id_ะผะตะฝะตะดะถะตัะฐ, ะดะฐัะฐ_ะทะฐะบะฐะทะฐ, ะดะฐัะฐ_ะณะพัะพะฒะฝะพััะธ, ััะฐััั, ััะผะผะฐ_ะทะฐะบะฐะทะฐ, created_at, updated_at)
    VALUES 
    (p_id_ะบะปะธะตะฝัะฐ, p_id_ะผะตะฝะตะดะถะตัะฐ, CURRENT_DATE, p_ะดะฐัะฐ_ะณะพัะพะฒะฝะพััะธ, 'ะฟัะธะฝัั', 0, NOW(), NOW())
    RETURNING id_ะทะฐะบะฐะทะฐ INTO v_id_ะทะฐะบะฐะทะฐ;
    
    RETURN v_id_ะทะฐะบะฐะทะฐ;
END;
$$ LANGUAGE plpgsql;
```

#### **ะัะพัะตะดััะฐ: ะะพัััะฟะปะตะฝะธะต ะทะฐะบัะฟะบะธ (ัะฒะตะปะธัะตะฝะธะต ะพััะฐัะบะพะฒ)**
```sql
CREATE OR REPLACE FUNCTION f_ะฟะพัััะฟะปะตะฝะธะต_ะทะฐะบัะฟะบะธ(p_id_ะทะฐะบัะฟะบะธ INTEGER)
RETURNS VOID AS $$
BEGIN
    -- ะะฑะฝะพะฒะธัั ััะฐััั ะทะฐะบัะฟะบะธ
    UPDATE ะทะฐะบัะฟะบะธ_ะผะฐัะตัะธะฐะปะพะฒ
    SET ััะฐััั = 'ะฒัะฟะพะปะฝะตะฝะพ'
    WHERE id_ะทะฐะบัะฟะบะธ = p_id_ะทะฐะบัะฟะบะธ;
    
    -- ะฃะฒะตะปะธัะธัั ะพััะฐัะบะธ ะฟะพ ะบะฐะถะดะพะผั ะผะฐัะตัะธะฐะปั ะฒ ะทะฐะบัะฟะบะต
    UPDATE ะผะฐัะตัะธะฐะปั ะผ
    SET ะบะพะปะธัะตััะฒะพ_ะฝะฐ_ัะบะปะฐะดะต = ะบะพะปะธัะตััะฒะพ_ะฝะฐ_ัะบะปะฐะดะต + ัะท.ะบะพะปะธัะตััะฒะพ
    FROM ัะพััะฐะฒ_ะทะฐะบัะฟะบะธ ัะท
    WHERE ะผ.id_ะผะฐัะตัะธะฐะปะฐ = ัะท.id_ะผะฐัะตัะธะฐะปะฐ
      AND ัะท.id_ะทะฐะบัะฟะบะธ = p_id_ะทะฐะบัะฟะบะธ;
END;
$$ LANGUAGE plpgsql;
```

#### **ะัะพัะตะดััะฐ: ะะฐัััั ัะตะฑะตััะพะธะผะพััะธ ะทะฐะบะฐะทะฐ**
```sql
CREATE OR REPLACE FUNCTION f_ัะฐัััะธัะฐัั_ัะตะฑะตััะพะธะผะพััั_ะทะฐะบะฐะทะฐ(p_id_ะทะฐะบะฐะทะฐ INTEGER)
RETURNS NUMERIC AS $$
DECLARE
    v_ัะตะฑะตััะพะธะผะพััั NUMERIC := 0;
BEGIN
    SELECT COALESCE(SUM(ัะผ.ะบะพะปะธัะตััะฒะพ_ะผะฐัะตัะธะฐะปะฐ * ะผ.ัะตะฝะฐ_ะทะฐ_ะตะดะธะฝะธัั), 0)
    INTO v_ัะตะฑะตััะพะธะผะพััั
    FROM ัะพััะฐะฒ_ะทะฐะบะฐะทะฐ ัะท
    JOIN ัะพััะฐะฒ_ะธะทะดะตะปะธั ัะธ ON ัะท.id_ะธะทะดะตะปะธั = ัะธ.id_ะธะทะดะตะปะธั
    JOIN ัะพััะฐะฒ_ะทะฐะณะพัะพะฒะบะธ ัะทะณ ON ัะธ.id_ะทะฐะณะพัะพะฒะบะธ = ัะทะณ.id_ะทะฐะณะพัะพะฒะบะธ
    JOIN ัะฐััะพะด_ะผะฐัะตัะธะฐะปะพะฒ ัะผ ON ัะทะณ.id_ะทะฐะณะพัะพะฒะบะธ = ัะผ.id_ะทะฐะณะพัะพะฒะบะธ
    JOIN ะผะฐัะตัะธะฐะปั ะผ ON ัะผ.id_ะผะฐัะตัะธะฐะปะฐ = ะผ.id_ะผะฐัะตัะธะฐะปะฐ
    WHERE ัะท.id_ะทะฐะบะฐะทะฐ = p_id_ะทะฐะบะฐะทะฐ;
    
    RETURN v_ัะตะฑะตััะพะธะผะพััั;
END;
$$ LANGUAGE plpgsql;
```

### 6.3 ะคัะฝะบัะธะธ (Functions)

#### **ะคัะฝะบัะธั: ะัะพะฒะตัะบะฐ ะฝะฐะปะธัะธั ะผะฐัะตัะธะฐะปะพะฒ ะดะปั ะทะฐะบะฐะทะฐ**
```sql
CREATE OR REPLACE FUNCTION f_ะฟัะพะฒะตัะธัั_ะฝะฐะปะธัะธะต_ะผะฐัะตัะธะฐะปะพะฒ(p_id_ะทะฐะบะฐะทะฐ INTEGER)
RETURNS BOOLEAN AS $$
DECLARE
    v_ะฝะตะดะพััะฐัะพะบ BOOLEAN := FALSE;
BEGIN
    -- ะัะพะฒะตัะธัั, ะตััั ะปะธ ะผะฐัะตัะธะฐะปั ะฒ ะฝะตะดะพััะฐัะบะต
    SELECT EXISTS(
        SELECT 1
        FROM ัะพััะฐะฒ_ะทะฐะบะฐะทะฐ ัะท
        JOIN ัะพััะฐะฒ_ะธะทะดะตะปะธั ัะธ ON ัะท.id_ะธะทะดะตะปะธั = ัะธ.id_ะธะทะดะตะปะธั
        JOIN ัะพััะฐะฒ_ะทะฐะณะพัะพะฒะบะธ ัะทะณ ON ัะธ.id_ะทะฐะณะพัะพะฒะบะธ = ัะทะณ.id_ะทะฐะณะพัะพะฒะบะธ
        JOIN ัะฐััะพะด_ะผะฐัะตัะธะฐะปะพะฒ ัะผ ON ัะทะณ.id_ะทะฐะณะพัะพะฒะบะธ = ัะผ.id_ะทะฐะณะพัะพะฒะบะธ
        JOIN ะผะฐัะตัะธะฐะปั ะผ ON ัะผ.id_ะผะฐัะตัะธะฐะปะฐ = ะผ.id_ะผะฐัะตัะธะฐะปะฐ
        WHERE ัะท.id_ะทะฐะบะฐะทะฐ = p_id_ะทะฐะบะฐะทะฐ
          AND ะผ.ะบะพะปะธัะตััะฒะพ_ะฝะฐ_ัะบะปะฐะดะต < (ัะผ.ะบะพะปะธัะตััะฒะพ_ะผะฐัะตัะธะฐะปะฐ * ัะท.ะบะพะปะธัะตััะฒะพ_ะธะทะดะตะปะธะน)
    ) INTO v_ะฝะตะดะพััะฐัะพะบ;
    
    RETURN NOT v_ะฝะตะดะพััะฐัะพะบ;
END;
$$ LANGUAGE plpgsql;
```

#### **ะคัะฝะบัะธั: ะะพะปััะตะฝะธะต ััะฐัะธััะธะบะธ ะฟะพ ัะพัััะดะฝะธะบั**
```sql
CREATE OR REPLACE FUNCTION f_ััะฐัะธััะธะบะฐ_ัะพัััะดะฝะธะบะฐ(p_id_ัะพัััะดะฝะธะบะฐ INTEGER)
RETURNS TABLE(
    ะฒัะตะณะพ_ะทะฐะบะฐะทะพะฒ INTEGER,
    ะฒัะฟะพะปะฝะตะฝะพ_ะฒ_ััะพะบ INTEGER,
    ะฟัะพััะพัะตะฝะพ INTEGER,
    ััะตะดะฝะตะต_ะฒัะตะผั_ัะฐัะพะฒ NUMERIC
) AS $$
BEGIN
    RETURN QUERY
    SELECT 
        COUNT(DISTINCT ะฟะท.id_ะทะฐะบะฐะทะฐ)::INTEGER,
        COUNT(DISTINCT CASE WHEN ะฟะท.ััะฐััั = 'ะฒัะฟะพะปะฝะตะฝะพ' AND ะฟะท.ะดะฐัะฐ_ัะฐะบั <= ะฟะท.ะดะฐัะฐ_ะฟะปะฐะฝ THEN ะฟะท.id_ะทะฐะบะฐะทะฐ END)::INTEGER,
        COUNT(DISTINCT CASE WHEN ะฟะท.ััะฐััั = 'ะฟัะพััะพัะตะฝะพ' THEN ะฟะท.id_ะทะฐะบะฐะทะฐ END)::INTEGER,
        ROUND(AVG(EXTRACT(EPOCH FROM (ะฟะท.ะดะฐัะฐ_ัะฐะบั - ะฟะท.ะดะฐัะฐ_ะฟะปะฐะฝ)) / 3600), 2)::NUMERIC
    FROM ะฟะปะฐะฝ_ะทะฐะณะพัะพะฒะพะบ ะฟะท
    WHERE ะฟะท.id_ัะฑะพััะธะบะฐ = p_id_ัะพัััะดะฝะธะบะฐ;
END;
$$ LANGUAGE plpgsql;
```

---

## 7. ะะะะะะก-ะะะะะะะ ะ ะะะะะะะงะะะะฏ

### 7.1 ะะณัะฐะฝะธัะตะฝะธั ะดะฐะฝะฝัั

1. **ะกะพัััะดะฝะธะบะธ:**
   - ะะพะทัะฐัั >= 18 ะปะตั (ะฟัะธ ะฝะฐะนะผะต)
   - ะะพะผะตั ัะตะปะตัะพะฝะฐ ัะฝะธะบะฐะปะตะฝ
   - ะะฐัะฐ ัะฒะพะปัะฝะตะฝะธั >= ะะฐัะฐ ะฝะฐะนะผะฐ

2. **ะะฐัะตัะธะฐะปั:**
   - ะะพะปะธัะตััะฒะพ ะฝะฐ ัะบะปะฐะดะต > 0
   - ะฆะตะฝะฐ > 0
   - ะััะธะบัะป ัะฝะธะบะฐะปะตะฝ

3. **ะะฐะบะฐะทั:**
   - ะะฐัะฐ ะทะฐะบะฐะทะฐ <= ะขะตะบััะตะน ะดะฐัั
   - ะะฐัะฐ ะณะพัะพะฒะฝะพััะธ >= ะขะตะบััะตะน ะดะฐัั + 1 ะดะตะฝั
   - ะกัะผะผะฐ ะทะฐะบะฐะทะฐ >= 0
   - ะกัะฐััั ะฟะตัะตัะพะดะธั: ะฟัะธะฝัั โ ะฒ_ะพะฑัะฐะฑะพัะบะต โ ะฒัะฟะพะปะฝะตะฝ (ะฝะตะปัะทั ะฟัะพะฟััะบะฐัั)

4. **ะะฐะบัะฟะบะธ:**
   - ะะพะปะธัะตััะฒะพ > 0
   - ะกัะฐััั: ะพะถะธะดะฐะตั_ะฟะพะดัะฒะตัะถะดะตะฝะธั โ ะฟะพะดัะฒะตัะถะดะตะฝะพ โ ะฒัะฟะพะปะฝะตะฝะพ

5. **ะัะฐัะธะบ ัะฐะฑะพัั:**
   - ะะต ะดะพะฟััะบะฐัััั ะฟัะพะฟััะบะธ ะดะฐั
   - ะัะธ ัะพะทะดะฐะฝะธะธ ะฟะปะฐะฝะฐ ะฟัะพะฒะตัััั ะฝะฐะปะธัะธะต ัะฐะฑะพัะธั ะดะฝะตะน

### 7.2 ะะฐัะบะฐะดะฝัะต ะดะตะนััะฒะธั

- **ะัะธ ัะดะฐะปะตะฝะธะธ ัะพัััะดะฝะธะบะฐ:** ะะฐะทะฝะฐัะธัั ะฝะพะฒัั ะธัะฟะพะปะฝะธัะตะปะตะน ะฝะฐ ะตะณะพ ะฝะตะฒัะฟะพะปะฝะตะฝะฝัะต ะทะฐะบะฐะทั
- **ะัะธ ะพัะผะตะฝะต ะทะฐะบะฐะทะฐ:** ะะตัะฝััั ะทะฐัะตะทะตัะฒะธัะพะฒะฐะฝะฝัะต ะผะฐัะตัะธะฐะปั ะฝะฐ ัะบะปะฐะด
- **ะัะธ ะธะทะผะตะฝะตะฝะธะธ ัะตะฝั ะผะฐัะตัะธะฐะปะฐ:** ะะตัะตััะธัะฐัั ัะตะฑะตััะพะธะผะพััั ะฐะบัะธะฒะฝัั ะทะฐะบะฐะทะพะฒ

---

## 8. ะคะฃะะะฆะะะะะะฌะะซะ ะขะะะะะะะะะฏ

### 8.1 ะัะฝะพะฒะฝะพะน ััะฝะบัะธะพะฝะฐะป (ะพะฑัะทะฐัะตะปัะฝะพ)

#### **ะะพะดัะปั 1: ะััะตะฝัะธัะธะบะฐัะธั ะธ ะฐะฒัะพัะธะทะฐัะธั**
- [ ] ะคะพัะผะฐ ะฒัะพะดะฐ (ะปะพะณะธะฝ/ะฟะฐัะพะปั ะธะปะธ ะฝะพะผะตั ัะตะปะตัะพะฝะฐ)
- [ ] ะัะพะฒะตัะบะฐ ะฟะฐัะพะปั (ะผะธะฝะธะผัะผ 8 ัะธะผะฒะพะปะพะฒ, ะฒะบะปััะธัั ะฑัะบะฒั ะธ ัะธััั)
- [ ] ะกะธััะตะผะฐ ัะพะปะตะน (ะกะฑะพััะธะบ/ะะตะฝะตะดะถะตั/ะะธัะตะบัะพั)
- [ ] ะะธัะฝัะน ะบะฐะฑะธะฝะตั ะฟะพะปัะทะพะฒะฐัะตะปั
- [ ] ะกะผะตะฝะฐ ะฟะพะปัะทะพะฒะฐัะตะปั ะฑะตะท ะฒััะพะดะฐ ะธะท ะฟัะธะปะพะถะตะฝะธั
- [ ] ะกะผะตะฝะฐ ะฟะฐัะพะปั
- [ ] ะะตะณะธัััะฐัะธั ะฝะพะฒะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั (ัะพะปัะบะพ ะะธัะตะบัะพั)

#### **ะะพะดัะปั 2: CRUD ะพะฟะตัะฐัะธะธ**
ะะปั ะบะฐะถะดะพะน ัะฐะฑะปะธัั ัะตะฐะปะธะทะพะฒะฐัั:
- [ ] **ะะพะฑะฐะฒะปะตะฝะธะต** (INSERT) ั ะฒะฐะปะธะดะฐัะธะตะน
- [ ] **ะะฑะฝะพะฒะปะตะฝะธะต** (UPDATE) ั ัะพััะฐะฝะตะฝะธะตะผ ะธััะพัะธะธ ะธะทะผะตะฝะตะฝะธะน
- [ ] **ะฃะดะฐะปะตะฝะธะต** (DELETE) ั ะฟะพะดัะฒะตัะถะดะตะฝะธะตะผ
- [ ] **ะัะพัะผะพัั** (SELECT) ะฒ ัะฐะฑะปะธัะต ั ะฟะฐะณะธะฝะฐัะธะตะน

**ะขะฐะฑะปะธัั ะดะปั CRUD:**
1. ะะปะธะตะฝัั
2. ะกะพัััะดะฝะธะบะธ
3. ะะฐัะตัะธะฐะปั
4. ะะทะดะตะปะธั
5. ะะฐะณะพัะพะฒะบะธ
6. ะะฐะบะฐะทั

#### **ะะพะดัะปั 3: ะะพะธัะบ ะธ ัะธะปัััะฐัะธั**
- [ ] ะะพะธัะบ ะฟะพ ะพะดะฝะพะผั ะฟะฐัะฐะผะตััั (ะฑะฐะทะพะฒัะน)
- [ ] ะะฝะพะณะพะบัะธัะตัะธะฐะปัะฝัะน ะฟะพะธัะบ (ะพะฟัะธะพะฝะฐะปัะฝัะน)
- [ ] ะกะพััะธัะพะฒะบะฐ ัะตะทัะปััะฐัะพะฒ
- [ ] ะคะธะปัััั ะฟะพ ะดะฐัะต, ััะฐัััั, ััะผะผะต

#### **ะะพะดัะปั 4: ะฃะฟัะฐะฒะปะตะฝะธะต ะทะฐะบะฐะทะฐะผะธ**
- [ ] ะะตะณะธัััะฐัะธั ะฝะพะฒะพะณะพ ะทะฐะบะฐะทะฐ
- [ ] ะัะฑะพั ะบะปะธะตะฝัะฐ ะธะท ัะฟัะฐะฒะพัะฝะธะบะฐ
- [ ] ะะพะฑะฐะฒะปะตะฝะธะต ะธะทะดะตะปะธะน ะฒ ะทะฐะบะฐะท
- [ ] ะะฐัััั ััะผะผั ะฐะฒัะพะผะฐัะธัะตัะบะธ
- [ ] ะะทะผะตะฝะตะฝะธะต ััะฐัััะฐ ะทะฐะบะฐะทะฐ (ั ะฟัะพะฒะตัะบะฐะผะธ ะฒ ะะ)
- [ ] ะัะพัะผะพัั ะธััะพัะธะธ ะทะฐะบะฐะทะพะฒ ะบะปะธะตะฝัะฐ

#### **ะะพะดัะปั 5: ะฃะฟัะฐะฒะปะตะฝะธะต ะผะฐัะตัะธะฐะปะฐะผะธ ะธ ัะบะปะฐะดะพะผ**
- [ ] ะกะฟัะฐะฒะพัะฝะธะบ ะผะฐัะตัะธะฐะปะพะฒ
- [ ] ะฃััั ะพััะฐัะบะพะฒ ะฝะฐ ัะบะปะฐะดะต
- [ ] ะัะพัะผะปะตะฝะธะต ะทะฐะบัะฟะบะธ
- [ ] ะะพัััะฟะปะตะฝะธะต ะทะฐะบัะฟะบะธ
- [ ] ะััะปะตะถะธะฒะฐะฝะธะต ะผะธะฝะธะผะฐะปัะฝัั ะพััะฐัะบะพะฒ
- [ ] ะกะธะณะฝะฐะป ะฟัะธ ะฝะตะดะพััะฐัะบะต ะผะฐัะตัะธะฐะปะพะฒ

#### **ะะพะดัะปั 6: ะฃะฟัะฐะฒะปะตะฝะธะต ะฟัะพะธะทะฒะพะดััะฒะพะผ**
- [ ] ะะปะฐะฝ ัะฐะฑะพั ัะฑะพััะธะบะพะฒ
- [ ] ะัะผะตัะธัั ะฒัะฟะพะปะฝะตะฝะธะต ะทะฐะณะพัะพะฒะพะบ
- [ ] ะะพะฝััะพะปั ััะพะบะพะฒ (ะฟัะพััะพัะบะฐ ะฐะฒัะพะผะฐัะธัะตัะบะธ)
- [ ] ะัะฐัะธะบ ัะฐะฑะพัั ัะพัััะดะฝะธะบะพะฒ
- [ ] ะะฐัะฟัะตะดะตะปะตะฝะธะต ะทะฐะบะฐะทะพะฒ

---

## 9. ะะะะะะะะขะะะฌะะซะ ะคะฃะะะฆะะะะะ

### 9.1 ะะตะฝะตัะฐัะธั ะดะพะบัะผะตะฝัะพะฒ (PDF)
- [ ] ะกััั (Invoice)
- [ ] ะะฐะบะปะฐะดะฝะฐั (Packing List)
- [ ] ะะบั ะฒัะฟะพะปะฝัะฝะฝัั ัะฐะฑะพั (Certificate of Completion)
- [ ] ะัััั ะฟะพ ะทะฐะบะฐะทะฐะผ ะทะฐ ะฟะตัะธะพะด
- [ ] ะะพะณะพะฒะพั ั ะบะปะธะตะฝัะพะผ

**ะะฝััััะผะตะฝัั:** reportlab (PDF), openpyxl (Excel)

### 9.2 ะะฝะฐะปะธัะธะบะฐ ะธ ะพััััั
- [ ] ะััััะบะฐ ะฟะพ ะฟะตัะธะพะดะฐะผ
- [ ] ะกะตะฑะตััะพะธะผะพััั ะทะฐะบะฐะทะพะฒ
- [ ] ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั ัะพัััะดะฝะธะบะพะฒ
- [ ] ะกะบะพัะพััั ะฒัะฟะพะปะฝะตะฝะธั ะทะฐะบะฐะทะพะฒ
- [ ] ะััะฐัะบะธ ะผะฐัะตัะธะฐะปะพะฒ (ะดะธะฐะณัะฐะผะผะฐ)
- [ ] ะัะฐัะธะบ ะทะฐะณััะถะตะฝะฝะพััะธ ัะพัััะดะฝะธะบะพะฒ

### 9.3 ะญะบัะฟะพัั ะดะฐะฝะฝัั
- [ ] ะญะบัะฟะพัั ะทะฐะบะฐะทะพะฒ ะฒ Excel
- [ ] ะญะบัะฟะพัั ะผะฐัะตัะธะฐะปะพะฒ ะฒ Excel
- [ ] ะญะบัะฟะพัั ะพััััะพะฒ

### 9.4 ะะฐััะธัะตะฝะฝัะน ะฟะพะธัะบ
- [ ] ะะพะปะฝะพัะตะบััะพะฒัะน ะฟะพะธัะบ ะฟะพ ะฒัะตะผ ะฟะพะปัะผ
- [ ] ะะฒัะพะดะพะฟะพะปะฝะตะฝะธะต ะฟัะธ ะฒะฒะพะดะต (autocomplete)
- [ ] ะััะพัะธั ะฟะพะธัะบะพะฒ
- [ ] ะกะพััะฐะฝัะฝะฝัะต ัะธะปัััั

---

## 10. ะขะะะะะะะะะฏ ะ ะะะขะะะคะะะกะฃ

### 10.1 ะะปะฐะฒะฝะพะต ะพะบะฝะพ ะฟัะธะปะพะถะตะฝะธั
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Nova Forma CRM                         [ะะตะฝั] [ะััะพะด]โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ะะพะปัะทะพะฒะฐัะตะปั: ะะฒะฐะฝ ะกะธะดะพัะพะฒ | ะะพะปั: ะะตะฝะตะดะถะตั       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ [ะะปะธะตะฝัั] [ะะฐะบะฐะทั] [ะะฐัะตัะธะฐะปั] [ะัะพะธะทะฒะพะดััะฒะพ]     โ
โ [ะกะพัััะดะฝะธะบะธ] [ะััััั] [ะะฝะฐะปะธัะธะบะฐ] [ะะฐัััะพะนะบะธ]     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                       โ
โ              ะกะะะะะะะะะ ะะซะะะะะะะะ ะะะะะะะ         โ
โ                                                       โ
โ  [ะะพะฑะฐะฒะธัั] [ะะทะผะตะฝะธัั] [ะฃะดะฐะปะธัั] [ะะพะธัะบ] [ะัััั]  โ
โ                                                       โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ ID | ะคะะ        | ะขะตะปะตัะพะฝ       | ะะฐัะฐ ัะตะณะธัั โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค โ
โ  โ 1  | ะ. ะะตััะพะฒ | +79991234567  | 15.11.2024  โ โ
โ  โ 2  | ะ. ะกะธะดะพัะพะฒ| +79992345678  | 20.11.2024  โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  ะกััะฐะฝะธัะฐ 1 ะธะท 5  [< ะะฐะทะฐะด] [ะะฐะปะตะต >]              โ
โ                                                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 10.2 ะคะพัะผะฐ ะดะพะฑะฐะฒะปะตะฝะธั/ัะตะดะฐะบัะธัะพะฒะฐะฝะธั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะะพะฑะฐะฒะธัั ะฝะพะฒะพะณะพ ะบะปะธะตะฝัะฐ             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ะคะะ:           [________________]    โ
โ ะขะตะปะตัะพะฝ:       [________________]    โ
โ ะะะ:           [________________]    โ
โ ะะดัะตั:         [________________]    โ
โ ะัะธะผะตัะฐะฝะธะต:    [_________________]  โ
โ                [_________________]  โ
โ                                     โ
โ            [ะกะพััะฐะฝะธัั] [ะัะผะตะฝะฐ]     โ
โ                                     โ
โ โ ะัะต ะพะฑัะทะฐัะตะปัะฝัะต ะฟะพะปั ะทะฐะฟะพะปะฝะตะฝั   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 10.3 ะขัะตะฑะพะฒะฐะฝะธั ะบ ัะพะผะฐะผ

- [ ] ะะพะปั ะฒะฒะพะดะฐ ั ะฟะพะดัะบะฐะทะบะฐะผะธ (labels)
- [ ] ะะฐะปะตะฝะดะฐัะธ ะดะปั ะดะฐั (QDateEdit)
- [ ] ะะฐัะบััะฒะฐััะธะตัั ัะฟะธัะบะธ ะดะปั ัะฟัะฐะฒะพัะฝะธะบะพะฒ
- [ ] ะะฐะดะธะพะบะฝะพะฟะบะธ ะดะปั ะฒัะฑะพัะฐ ััะฐัััะฐ
- [ ] ะขะตะบััะพะฒัะต ะพะฑะปะฐััะธ (QTextEdit) ะดะปั ะดะปะธะฝะฝัั ัะตะบััะพะฒ
- [ ] ะะฐะปะธะดะฐัะธั ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ
- [ ] ะกะพะพะฑัะตะฝะธั ะพะฑ ะพัะธะฑะบะฐั ะฝะฐ ััััะบะพะผ ัะทัะบะต
- [ ] ะะฝะพะฟะบะธ "ะกะพััะฐะฝะธัั", "ะัะผะตะฝะฐ", "ะฃะดะฐะปะธัั"

### 10.4 ะกะพะพะฑัะตะฝะธั ะพะฑ ะพัะธะฑะบะฐั

```
ะัะธะผะตั:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะัะธะฑะบะฐ ะฟัะธ ะดะพะฑะฐะฒะปะตะฝะธะธ ะทะฐะบะฐะทะฐ

ะัะธัะธะฝะฐ: ะะฐัะฐ ะณะพัะพะฒะฝะพััะธ ะฝะต ะผะพะถะตั ะฑััั ะฒ ะฟัะพัะปะพะผ.
         ะฃะบะฐะถะธัะต ะดะฐัั ะณะพัะพะฒะฝะพััะธ ะฝะต ัะฐะฝะตะต, ัะตะผ ัะตะณะพะดะฝั.

ะะตะนััะฒะธะต: ะะทะผะตะฝะธัะต ะดะฐัั ะธ ะฟะพะฒัะพัะธัะต ะฟะพะฟััะบั.

                           [OK]
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 11. ะกะขะะฃะะขะฃะะ ะะะะะะขะ

```
nova_forma_crm/
โโโ README.md                          # ะะพะบัะผะตะฝัะฐัะธั
โโโ requirements.txt                   # ะะฐะฒะธัะธะผะพััะธ Python
โโโ config.py                          # ะะพะฝัะธะณััะฐัะธั ะฟะพะดะบะปััะตะฝะธั ะบ ะะ
โโโ main.py                            # ะขะพัะบะฐ ะฒัะพะดะฐ
โ
โโโ db/                                # ะกะปะพะน ะฑะฐะทั ะดะฐะฝะฝัั
โ   โโโ __init__.py
โ   โโโ connection.py                  # ะะพะดะบะปััะตะฝะธะต ะบ PostgreSQL
โ   โโโ migrations/                    # SQL ะผะธะณัะฐัะธะธ
โ   โ   โโโ 001_create_tables.sql
โ   โ   โโโ 002_create_views.sql
โ   โ   โโโ 003_create_triggers.sql
โ   โ   โโโ 004_create_procedures.sql
โ   โโโ queries.py                     # ะะพัะพะฒัะต SQL ะทะฐะฟัะพัั
โ   โโโ seed_data.sql                  # ะะฐัะฐะปัะฝัะต ะดะฐะฝะฝัะต
โ
โโโ models/                            # ะะพะดะตะปะธ ะดะฐะฝะฝัั (ORM)
โ   โโโ __init__.py
โ   โโโ user.py
โ   โโโ employee.py
โ   โโโ client.py
โ   โโโ order.py
โ   โโโ material.py
โ   โโโ ...
โ
โโโ business_logic/                    # ะะธะทะฝะตั-ะปะพะณะธะบะฐ
โ   โโโ __init__.py
โ   โโโ auth_service.py                # ะะฒัะพัะธะทะฐัะธั
โ   โโโ order_service.py               # ะฃะฟัะฐะฒะปะตะฝะธะต ะทะฐะบะฐะทะฐะผะธ
โ   โโโ material_service.py            # ะฃะฟัะฐะฒะปะตะฝะธะต ะผะฐัะตัะธะฐะปะฐะผะธ
โ   โโโ employee_service.py            # ะฃะฟัะฐะฒะปะตะฝะธะต ัะพัััะดะฝะธะบะฐะผะธ
โ   โโโ report_generator.py            # ะะตะฝะตัะฐัะธั ะพััััะพะฒ
โ   โโโ validators.py                  # ะะฐะปะธะดะฐัะธั ะดะฐะฝะฝัั
โ
โโโ ui/                                # PyQt ะธะฝัะตััะตะนั
โ   โโโ __init__.py
โ   โโโ windows/
โ   โ   โโโ __init__.py
โ   โ   โโโ main_window.py             # ะะปะฐะฒะฝะพะต ะพะบะฝะพ
โ   โ   โโโ login_window.py            # ะะบะฝะพ ะฒัะพะดะฐ
โ   โ   โโโ profile_window.py          # ะะธัะฝัะน ะบะฐะฑะธะฝะตั
โ   โ   โโโ about_window.py
โ   โโโ dialogs/
โ   โ   โโโ __init__.py
โ   โ   โโโ add_client_dialog.py       # ะะธะฐะปะพะณ ะดะพะฑะฐะฒะปะตะฝะธั ะบะปะธะตะฝัะฐ
โ   โ   โโโ add_order_dialog.py        # ะะธะฐะปะพะณ ะดะพะฑะฐะฒะปะตะฝะธั ะทะฐะบะฐะทะฐ
โ   โ   โโโ order_detail_dialog.py     # ะะพะดัะพะฑะฝัะน ะฟัะพัะผะพัั ะทะฐะบะฐะทะฐ
โ   โ   โโโ search_dialog.py           # ะะพะธัะบ
โ   โ   โโโ filter_dialog.py           # ะคะธะปัััั
โ   โโโ widgets/
โ   โ   โโโ __init__.py
โ   โ   โโโ clients_tab.py             # ะะบะปะฐะดะบะฐ "ะะปะธะตะฝัั"
โ   โ   โโโ orders_tab.py              # ะะบะปะฐะดะบะฐ "ะะฐะบะฐะทั"
โ   โ   โโโ materials_tab.py           # ะะบะปะฐะดะบะฐ "ะะฐัะตัะธะฐะปั"
โ   โ   โโโ production_tab.py          # ะะบะปะฐะดะบะฐ "ะัะพะธะทะฒะพะดััะฒะพ"
โ   โ   โโโ employees_tab.py           # ะะบะปะฐะดะบะฐ "ะกะพัััะดะฝะธะบะธ"
โ   โ   โโโ reports_tab.py             # ะะบะปะฐะดะบะฐ "ะััััั"
โ   โ   โโโ analytics_tab.py           # ะะบะปะฐะดะบะฐ "ะะฝะฐะปะธัะธะบะฐ"
โ   โโโ resources/
โ       โโโ icons/
โ       โโโ styles.qss                 # ะกัะธะปะธ CSS
โ       โโโ images/
โ
โโโ utils/                             # ะฃัะธะปะธัั
โ   โโโ __init__.py
โ   โโโ logger.py                      # ะะพะณะธัะพะฒะฐะฝะธะต
โ   โโโ constants.py                   # ะะพะฝััะฐะฝัั
โ   โโโ helpers.py                     # ะัะฟะพะผะพะณะฐัะตะปัะฝัะต ััะฝะบัะธะธ
โ   โโโ decorators.py                  # ะะตะบะพัะฐัะพัั
โ
โโโ tests/                             # ะขะตััั
    โโโ __init__.py
    โโโ test_auth.py
    โโโ test_orders.py
    โโโ test_materials.py
    โโโ test_db_triggers.py
```

---

## 12. ะขะะฅะะะงะะกะะะ ะขะะะะะะะะะฏ

### 12.1 ะขัะตะฑะพะฒะฐะฝะธั ะบ ะะ

- **ะกะฃะะ:** PostgreSQL 14+
- **ะขะธะฟ ััะฐะฝะธะปะธัะฐ:** ะะตะปััะธะพะฝะฝะฐั ะผะพะดะตะปั
- **ะะพะดะธัะพะฒะบะฐ:** UTF-8
- **ะขะฐะฑะปะธัั:** ะะธะฝะธะผัะผ 15 ัะฐะฑะปะธั
- **ะัะตะดััะฐะฒะปะตะฝะธั (Views):** ะะธะฝะธะผัะผ 5
- **ะัะพัะตะดััั (Procedures):** ะะธะฝะธะผัะผ 3
- **ะขัะธะณะณะตัั (Triggers):** ะะธะฝะธะผัะผ 5
- **ะคัะฝะบัะธะธ (Functions):** ะะธะฝะธะผัะผ 3

### 12.2 ะขัะตะฑะพะฒะฐะฝะธั ะบ ะฟัะธะปะพะถะตะฝะธั

- **ะฏะทัะบ:** Python 3.9+
- **Framework:** PyQt5/PyQt6
- **ะะก:** Windows 10+, Linux, macOS
- **ะญะบัะฐะฝ:** ะะธะฝะธะผัะผ 1024x768
- **ะัะฐัะทะตั:** N/A (ะฝะฐััะพะปัะฝะพะต ะฟัะธะปะพะถะตะฝะธะต)
- **ะะธะฝะธะผัะผ ะะะฃ:** 512 MB
- **ะะธะฝะธะผัะผ HDD:** 100 MB

### 12.3 ะะฐะฒะธัะธะผะพััะธ Python

```
psycopg2-binary==2.9.x           # ะัะฐะนะฒะตั PostgreSQL
PyQt5==5.15.x                    # GUI
PyQt5-sip==12.x                  # Support ะดะปั PyQt5
reportlab==4.x                   # ะะตะฝะตัะฐัะธั PDF
openpyxl==3.x                    # ะะฐะฑะพัะฐ ั Excel
python-dotenv==0.x               # ะะพะฝัะธะณััะฐัะธั
sqlalchemy==2.x                  # ORM (ะพะฟัะธะพะฝะฐะปัะฝะพ)
bcrypt==4.x                      # ะฅะตัะธัะพะฒะฐะฝะธะต ะฟะฐัะพะปั
pydantic==2.x                    # ะะฐะปะธะดะฐัะธั ะดะฐะฝะฝัั
```

---

## 13. ะญะขะะะซ ะะะะะะะะขะะ

### **ะญัะฐะฟ 1: ะัะพะตะบัะธัะพะฒะฐะฝะธะต ะธ ะฟะพะดะณะพัะพะฒะบะฐ (2-3 ะดะฝั)**
- [ ] ะะฐะทัะฐะฑะพัะบะฐ ER-ะดะธะฐะณัะฐะผะผั (ััะพัะฝะตะฝะธะต)
- [ ] ะะฐะฟะธัะฐะฝะธะต SQL ัะบัะธะฟัะพะฒ ัะพะทะดะฐะฝะธั ัะฐะฑะปะธั
- [ ] ะกะพะทะดะฐะฝะธะต ะธ ัะตััะธัะพะฒะฐะฝะธะต ะฟัะตะดััะฐะฒะปะตะฝะธะน (Views)
- [ ] ะะฐะฟะธัะฐะฝะธะต ััะธะณะณะตัะพะฒ ะธ ะฟัะพัะตะดัั
- [ ] ะะพะดะณะพัะพะฒะบะฐ ัะตััะพะฒัั ะดะฐะฝะฝัั (100-150 ะทะฐะฟะธัะตะน)

### **ะญัะฐะฟ 2: ะะฝััะฐััััะบัััะฐ ะฟัะธะปะพะถะตะฝะธั (2-3 ะดะฝั)**
- [ ] ะะฐัััะพะนะบะฐ ะฟะพะดะบะปััะตะฝะธั ะบ ะะ
- [ ] ะกะพะทะดะฐะฝะธะต ะผะพะดะตะปะตะน ะดะฐะฝะฝัั (models.py)
- [ ] ะะฐะทัะฐะฑะพัะบะฐ ัะปะพั ะฑะธะทะฝะตั-ะปะพะณะธะบะธ
- [ ] ะะตะฐะปะธะทะฐัะธั ะฐะฒัะพัะธะทะฐัะธะธ
- [ ] ะกัััะบัััะฐ ะฟัะพะตะบัะฐ ะธ ะบะพะฝัะธะณััะฐัะธั

### **ะญัะฐะฟ 3: ะะฝัะตััะตะนั ะฟะพะปัะทะพะฒะฐัะตะปั (3-4 ะดะฝั)**
- [ ] ะะปะฐะฒะฝะพะต ะพะบะฝะพ ะฟัะธะปะพะถะตะฝะธั
- [ ] ะะบะปะฐะดะบะฐ "ะะปะธะตะฝัั" (CRUD)
- [ ] ะะบะปะฐะดะบะฐ "ะะฐะบะฐะทั" (CRUD + ััะฐัััั)
- [ ] ะะบะปะฐะดะบะฐ "ะะฐัะตัะธะฐะปั" (CRUD)
- [ ] ะะบะปะฐะดะบะฐ "ะกะพัััะดะฝะธะบะธ" (CRUD + ะณัะฐัะธะบ)
- [ ] ะะบะปะฐะดะบะฐ "ะัะพะธะทะฒะพะดััะฒะพ" (ะฟะปะฐะฝ ัะฐะฑะพั)

### **ะญัะฐะฟ 4: ะคัะฝะบัะธะพะฝะฐะปัะฝะพััั (2-3 ะดะฝั)**
- [ ] ะะพะธัะบ ะธ ัะธะปัััะฐัะธั
- [ ] ะะฐะปะธะดะฐัะธั ะฟะพะปัะทะพะฒะฐัะตะปััะบะพะณะพ ะฒะฒะพะดะฐ
- [ ] ะกะพะพะฑัะตะฝะธั ะพะฑ ะพัะธะฑะบะฐั
- [ ] ะะฑัะฐะฑะพัะบะฐ ะธัะบะปััะตะฝะธะน
- [ ] ะะพะณะธัะพะฒะฐะฝะธะต ะพะฟะตัะฐัะธะน

### **ะญัะฐะฟ 5: ะะพะฟะพะปะฝะธัะตะปัะฝัะน ััะฝะบัะธะพะฝะฐะป (2-3 ะดะฝั)**
- [ ] ะะตะฝะตัะฐัะธั ะพััััะพะฒ (PDF)
- [ ] ะญะบัะฟะพัั ะฒ Excel
- [ ] ะะฝะฐะปะธัะธะบะฐ ะธ ะณัะฐัะธะบะธ
- [ ] ะะธัะฝัะน ะบะฐะฑะธะฝะตั ะฟะพะปัะทะพะฒะฐัะตะปั
- [ ] ะะฐัััะพะนะบะธ ะฟัะธะปะพะถะตะฝะธั

### **ะญัะฐะฟ 6: ะขะตััะธัะพะฒะฐะฝะธะต ะธ ะดะพะบัะผะตะฝัะธัะพะฒะฐะฝะธะต (1-2 ะดะฝั)**
- [ ] ะะพะดัะปัะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต (unit tests)
- [ ] ะะฝัะตะณัะฐัะธะพะฝะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต
- [ ] ะะพะปัะทะพะฒะฐัะตะปััะบะพะต ัะตััะธัะพะฒะฐะฝะธะต
- [ ] ะะพะบัะผะตะฝัะธัะพะฒะฐะฝะธะต ะบะพะดะฐ
- [ ] README.md ะธ ะธะฝััััะบัะธะธ ะฟะพ ัะฐะทะฒััััะฒะฐะฝะธั

### **ะัะพะณะพ:** ~13-18 ะดะฝะตะน ัะฐะทัะฐะฑะพัะบะธ

---

## 14. ะะะะขะะะะ ะฃะกะะะฅะ

### **ะะปั ะพัะตะฝะบะธ "ะฅะพัะพัะพ":**
- โ ะัะต ัะฐะฑะปะธัั ัะพะทะดะฐะฝั ะธ ัะฒัะทะฐะฝั
- โ CRUD ะพะฟะตัะฐัะธะธ ัะฐะฑะพัะฐัั
- โ ะกะธััะตะผะฐ ะฐะฒัะพัะธะทะฐัะธะธ ัะฐะฑะพัะฐะตั
- โ ะะพะธัะบ ะฟะพ ะพะดะฝะพะผั ะฟะฐัะฐะผะตััั
- โ ะะฝัะตััะตะนั PyQt ััะฝะบัะธะพะฝะฐะปะตะฝ
- โ ะัะต ะฑะธะทะฝะตั-ะฟัะฐะฒะธะปะฐ ัะตะฐะปะธะทะพะฒะฐะฝั ะฝะฐ ััะพะฒะฝะต ะะ

### **ะะปั ะพัะตะฝะบะธ "ะัะปะธัะฝะพ":**
- โ ะัะต ะบัะธัะตัะธะธ "ะฅะพัะพัะพ"
- โ ะะธะฝะธะผัะผ 5 ััะธะณะณะตัะพะฒ ะฒ ะะ
- โ ะะธะฝะธะผัะผ 3 ััะฐะฝะธะผัะต ะฟัะพัะตะดััั
- โ ะะธะฝะธะผัะผ 3 ััะฝะบัะธะธ
- โ ะัะตะดััะฐะฒะปะตะฝะธั ะดะปั ัะบัััะธั ID
- โ ะะตะฝะตัะฐัะธั PDF ะดะพะบัะผะตะฝัะพะฒ
- โ ะะฝะพะณะพะบัะธัะตัะธะฐะปัะฝัะน ะฟะพะธัะบ
- โ ะะฝะฐะปะธัะธะบะฐ ะธ ะพััััั
- โ ะะพะปะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ะพะฟะตัะฐัะธะน
- โ Comprehensive ะดะพะบัะผะตะฝัะธัะพะฒะฐะฝะธะต

---

## 15. ะฃะกะขะะะะะะ ะ ะะะะฃะกะ

### 15.1 ะขัะตะฑะพะฒะฐะฝะธั
```bash
# ะฃััะฐะฝะพะฒะธัั Python 3.9+
# ะฃััะฐะฝะพะฒะธัั PostgreSQL 14+
# ะฃััะฐะฝะพะฒะธัั pip
```

### 15.2 ะะพะดะณะพัะพะฒะบะฐ ะะ

```bash
# 1. ะะพะดะบะปััะธัััั ะบ PostgreSQL
psql -U postgres

# 2. ะกะพะทะดะฐัั ะฑะฐะทั ะดะฐะฝะฝัั
CREATE DATABASE nova_forma_crm;

# 3. ะะพะดะบะปััะธัััั ะบ ะะ
\c nova_forma_crm

# 4. ะัะฟะพะปะฝะธัั ะผะธะณัะฐัะธะธ
\i db/migrations/001_create_tables.sql
\i db/migrations/002_create_views.sql
\i db/migrations/003_create_triggers.sql
\i db/migrations/004_create_procedures.sql

# 5. ะะฐะณััะทะธัั ัะตััะพะฒัะต ะดะฐะฝะฝัะต
\i db/seed_data.sql
```

### 15.3 ะะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั

```bash
# 1. ะะปะพะฝะธัะพะฒะฐัั ัะตะฟะพะทะธัะพัะธะน
git clone <repo>
cd nova_forma_crm

# 2. ะฃััะฐะฝะพะฒะธัั ะทะฐะฒะธัะธะผะพััะธ
pip install -r requirements.txt

# 3. ะะฐัััะพะธัั .env ัะฐะนะป
cp .env.example .env
# ะััะตะดะฐะบัะธัะพะฒะฐัั ะฟะพะดะบะปััะตะฝะธะต ะบ ะะ

# 4. ะะฐะฟัััะธัั ะฟัะธะปะพะถะตะฝะธะต
python main.py
```

### 15.4 ะะตัะฒัะน ะฒัะพะด

```
ะะพะณะธะฝ: admin
ะะฐัะพะปั: admin123
ะะพะปั: ะะธัะตะบัะพั
```

---

## 16. ะะะะฃะะะะขะะะะะะะะ ะะะะ

### 16.1 ะกัะฐะฝะดะฐััั

- **ะฏะทัะบ ะบะพะผะผะตะฝัะฐัะธะตะฒ:** ะัััะบะธะน
- **Docstrings:** ะะปั ะฒัะตั ััะฝะบัะธะน ะธ ะบะปะฐััะพะฒ
- **Docstring ัะพัะผะฐั:** Google style

ะัะธะผะตั:
```python
def ะดะพะฑะฐะฒะธัั_ะบะปะธะตะฝัะฐ(ัะธะพ: str, ะฝะพะผะตั_ัะตะปะตัะพะฝะฐ: str) -> int:
    """
    ะะพะฑะฐะฒะธัั ะฝะพะฒะพะณะพ ะบะปะธะตะฝัะฐ ะฒ ัะธััะตะผั.
    
    Args:
        ัะธะพ (str): ะะพะปะฝะพะต ะธะผั ะบะปะธะตะฝัะฐ
        ะฝะพะผะตั_ัะตะปะตัะพะฝะฐ (str): ะะพะผะตั ัะตะปะตัะพะฝะฐ ะบะปะธะตะฝัะฐ
    
    Returns:
        int: ID ัะพะทะดะฐะฝะฝะพะณะพ ะบะปะธะตะฝัะฐ
    
    Raises:
        ValueError: ะัะปะธ ะฝะพะผะตั ัะตะปะตัะพะฝะฐ ัะถะต ัััะตััะฒัะตั
        DatabaseError: ะัะปะธ ะฟัะพะธะทะพัะปะฐ ะพัะธะฑะบะฐ ะฟัะธ ะดะพะฑะฐะฒะปะตะฝะธะธ
    
    Example:
        >>> ะดะพะฑะฐะฒะธัั_ะบะปะธะตะฝัะฐ("ะะฒะฐะฝ ะะตััะพะฒ", "+79991234567")
        42
    """
```

---

## 17. ะะะะะฎะงะะะะ

ะัะพะตะบั **Nova Forma CRM** โ ััะพ ะฟะพะปะฝะพััะฝะบัะธะพะฝะฐะปัะฝะฐั ัะธััะตะผะฐ ัะฟัะฐะฒะปะตะฝะธั ัะตััััะฐะผะธ ะผะตะฑะตะปัะฝะพะณะพ ะฟัะตะดะฟัะธััะธั, ัะฐะทัะฐะฑะพัะฐะฝะฝะฐั ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ัะพะฒัะตะผะตะฝะฝัั ัะตัะฝะพะปะพะณะธะน ะธ ะปัััะธั ะฟัะฐะบัะธะบ.

**ะะปััะตะฒัะต ะพัะพะฑะตะฝะฝะพััะธ:**
- โ ะขััััะปะพะนะฝะฐั ะฐััะธัะตะบัััะฐ
- โ "ะขะพะฝะบะธะน ะบะปะธะตะฝั" ั ะปะพะณะธะบะพะน ะฒ ะะ
- โ ะะพะปะฝะฐั ัะธััะตะผะฐ ัะพะปะตะน ะธ ะฟัะฐะฒ ะดะพัััะฟะฐ
- โ ะฅัะฐะฝะธะผัะต ะฟัะพัะตะดััั ะธ ััะธะณะณะตัั
- โ ะัะตะดััะฐะฒะปะตะฝะธั ะดะปั ัะฟัะพัะตะฝะธั ัะฐะฑะพัั
- โ ะะฝััะธัะธะฒะฝัะน ะธะฝัะตััะตะนั PyQt5
- โ ะะตะฝะตัะฐัะธั ะพััััะพะฒ ะธ ะฐะฝะฐะปะธัะธะบะฐ
- โ ะะพะปะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ะพะฟะตัะฐัะธะน

**ะฃัะฟะตัะพะฒ ะฒ ัะฐะทัะฐะฑะพัะบะต! ๐**

---

**ะะพะบัะผะตะฝั ะฟะพะดะณะพัะพะฒะปะตะฝ:** 05.12.2024  
**ะะตััะธั:** 1.0  
**ะะฒัะพั:** ะขะ ะดะปั ะฟัะพะตะบัะฐ Nova Forma CRM